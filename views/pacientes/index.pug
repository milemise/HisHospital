extends ../layout

block content
  .card.shadow-sm.my-4
    .card-header.py-3
      .d-flex.justify-content-between.align-items-center
        h1.h4.mb-0 Gestión de Pacientes
        a.btn.btn-primary(href="/pacientes/nuevo")
          i.bi.bi-plus-lg.me-1
          | Nuevo Paciente
    .card-body
      if pacientes.length === 0
        .alert.alert-info.mb-0 No hay pacientes registrados en el sistema.
      else
        .table-responsive
          table.table.table-striped.table-hover.align-middle
            thead.table-light
              tr
                th ID
                th Nombre Completo
                th DNI
                th Fecha Nacimiento
                th Género
                th Obra Social
                th Activo
                th.text-center Acciones
            tbody
              each paciente in pacientes
                tr
                  td #{paciente.id_paciente}
                  td #{paciente.nombre} #{paciente.apellido}
                  td #{paciente.dni}
                  td #{paciente.fecha_nacimiento ? new Date(paciente.fecha_nacimiento).toLocaleDateString('es-ES') : 'N/A'}
                  td #{paciente.genero}
                  td #{paciente.obraSocial ? paciente.obraSocial.nombre : 'N/A'}
                  td
                    if paciente.activo
                      span.badge.bg-success Sí
                    else
                      span.badge.bg-danger No
                  td.text-center
                    .d-inline-flex.gap-2
                      a.btn.btn-sm.btn-outline-primary(href="/pacientes/editar/" + paciente.id_paciente) Editar
                      form(action="/pacientes/eliminar/" + paciente.id_paciente, method="POST", onsubmit="return confirm('¿Está seguro de eliminar a este paciente? Esto no es posible si tiene admisiones activas.');")
                        button.btn.btn-sm.btn-outline-danger(type="submit") Eliminar