extends ../layout

block content
  .max-w-4xl.mx-auto.bg-white.mt-10.p-8.rounded-2xl.shadow-xl
    h1.text-3xl.font-bold.text-blue-900.mb-6 Dar de Alta a Paciente

    // Información del Paciente y Admisión 
    .mb-6.p-5.border.border-gray-200.rounded-lg.bg-gray-50
      h3.text-lg.font-semibold.text-gray-800.mb-3 Detalles de la Admisión
      p.mb-2 #[strong ID Admisión:] #{admision.id_admision}
      p.mb-2 #[strong Paciente:] #{admision.paciente ? admision.paciente.nombre + ' ' + admision.paciente.apellido + ' (DNI: ' + admision.paciente.dni + ')' : 'Paciente Desconocido'}
      p.mb-2 #[strong Fecha de Ingreso:] #{admision.fecha_ingreso ? new Date(admision.fecha_ingreso).toLocaleString('es-ES') : 'N/A'}
      p.mb-2 #[strong Motivo de Internación:] #{admision.motivo_internacion || 'N/A'}
      p.mb-2 #[strong Estado Actual:] 
        span.px-2.inline-flex.text-sm.leading-5.font-semibold.rounded-full(class=(admision.estado_admision === 'Activa' ? 'bg-green-100 text-green-800' : admision.estado_admision === 'Dada de Alta' ? 'bg-blue-100 text-blue-800' : admision.estado_admision === 'Cancelada' ? 'bg-red-100 text-red-800' : 'bg-yellow-100 text-yellow-800')) #{admision.estado_admision}

    form(action="/altas", method="POST" class="space-y-6")
      input(type="hidden", name="id_admision", value=admision.id_admision)

      div.space-y-4.p-5.border.border-gray-200.rounded-lg.bg-gray-50
        h3.text-lg.font-semibold.text-gray-800.mb-3 Datos del Alta Médica
        div
          label.block.text-sm.font-medium.text-gray-700 Médico Responsable
          select(name="id_medico" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500")
            option(value="") Seleccionar Médico
            each medico in medicos
              option(value=medico.id_medico)= medico.nombre + ' ' + medico.apellido
        div
          label.block.text-sm.font-medium.text-gray-700 Diagnóstico Final
          textarea(name="diagnostico_final", placeholder="Diagnóstico final de internación" required rows="3" class="w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500")
        div
          label.block.text-sm.font-medium.text-gray-700 Tratamiento Indicado Post-Alta
          textarea(name="tratamiento_indicado", placeholder="Instrucciones de tratamiento, terapias, etc." required rows="3" class="w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500")
        div
          label.block.text-sm.font-medium.text-gray-700 Medicamentos Recetados
          textarea(name="medicamentos_recetados", placeholder="Lista de medicamentos y dosis" required rows="3" class="w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500")
        div
          label.block.text-sm.font-medium.text-gray-700 Fecha de Control Sugerido
          input(type="date", name="fecha_control_sugerido", class="w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500")
        div
          label.block.text-sm.font-medium.text-gray-700 Observaciones Adicionales
          textarea(name="observaciones_alta", rows="3" class="w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500")

      .flex.justify-end.space-x-4.mt-6
        a(href="/admisiones/detalles/" + admision.id_admision).bg-gray-600.hover:bg-gray-700.transition-colors.duration-300.text-white.font-semibold.py-2.px-4.rounded-md.shadow-md Cancelar
        button(type="submit").bg-yellow-600.hover:bg-yellow-700.transition-colors.duration-300.text-white.font-semibold.py-2.px-6.rounded-md.shadow-md Confirmar Alta